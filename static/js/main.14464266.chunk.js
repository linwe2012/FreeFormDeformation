(this["webpackJsonpffd-ts"]=this["webpackJsonpffd-ts"]||[]).push([[0],{60:function(e,t,n){},61:function(e,t,n){},66:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var o=n(9),a=n(0),i=n(12),c=n.n(i),s=(n(60),n(44)),r=n(38),l=(n(61),n(48)),u=n(3),h=n(6),p=function(){function e(t,n,o,a){var i=this;Object(u.a)(this,e),this.canvas=null,this.w=0,this.h=0,this.pickPosition={x:0,y:0},this.frame=null,this.clearPickPosition(),this.canvas=n,this.w=t.clientWidth,this.h=t.clientHeight,t.appendChild(n),t.mouseout=function(){return i.clearPickPosition()},this.frame=t,window.addEventListener("resize",(function(e){i.w=i.frame.clientWidth,i.h=i.frame.clientHeight,a(i.w,i.h)}))}return Object(h.a)(e,[{key:"Aspect",value:function(){return this.w/this.h}},{key:"getCanvasRelativePosition",value:function(e){var t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}},{key:"setPickPosition",value:function(e){var t=this.pickPosition,n=this.getCanvasRelativePosition(e);t.x=n.x/this.w*2-1,t.y=n.y/this.h*-2+1}},{key:"clearPickPosition",value:function(){var e=this.pickPosition;e.x=-1e5,e.y=-1e5}},{key:"onmousemove",set:function(e){this.frame.onmousemove=e}},{key:"onmousedown",set:function(e){this.frame.onmousedown=e}},{key:"onmouseup",set:function(e){this.frame.onmouseup=e}},{key:"onclick",set:function(e){this.frame.onclick=e}}]),e}(),d=n(1),m=function(e,t){var n=this,o=-1,a=0,i=1,c=2,s=3,r=4;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:d.J.ROTATE,MIDDLE:d.J.ZOOM,RIGHT:d.J.PAN},this.target=new d.wb;var l=1e-6,u=new d.wb,h=1,p=o,m=o,v=new d.wb,f=new d.vb,b=new d.vb,w=new d.wb,g=0,y=new d.vb,j=new d.vb,x=0,E=0,k=new d.vb,O=new d.vb;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var P={type:"change"},z={type:"start"},D={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}};var L=function(){var e=new d.vb;return function(t,o){return e.set((t-n.screen.left)/n.screen.width,(o-n.screen.top)/n.screen.height),e}}(),C=function(){var e=new d.vb;return function(t,o){return e.set((t-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-o))/n.screen.width),e}}();function S(e){if(!1!==n.enabled){if(e.preventDefault(),e.stopPropagation(),p===o)switch(e.button){case n.mouseButtons.LEFT:p=a;break;case n.mouseButtons.MIDDLE:p=i;break;case n.mouseButtons.RIGHT:p=c;break;default:p=o}var t=m!==o?m:p;t!==a||n.noRotate?t!==i||n.noZoom?t!==c||n.noPan||(k.copy(L(e.pageX,e.pageY)),O.copy(k)):(y.copy(L(e.pageX,e.pageY)),j.copy(y)):(b.copy(C(e.pageX,e.pageY)),f.copy(b)),document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",A,!1),n.dispatchEvent(z)}}function Y(e){if(!1!==n.enabled){e.preventDefault(),e.stopPropagation();var t=m!==o?m:p;t!==a||n.noRotate?t!==i||n.noZoom?t!==c||n.noPan||O.copy(L(e.pageX,e.pageY)):j.copy(L(e.pageX,e.pageY)):(f.copy(b),b.copy(C(e.pageX,e.pageY)))}}function A(e){!1!==n.enabled&&(e.preventDefault(),e.stopPropagation(),p=o,document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",A),n.dispatchEvent(D))}function R(e){if(!1!==n.enabled&&!0!==n.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:y.y-=.025*e.deltaY;break;case 1:y.y-=.01*e.deltaY;break;default:y.y-=25e-5*e.deltaY}n.dispatchEvent(z),n.dispatchEvent(D)}}function M(e){if(!1!==n.enabled){switch(e.preventDefault(),e.touches.length){case 1:p=s,b.copy(C(e.touches[0].pageX,e.touches[0].pageY)),f.copy(b);break;default:p=r;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;E=x=Math.sqrt(t*t+o*o);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;k.copy(L(a,i)),O.copy(k)}n.dispatchEvent(z)}}function X(e){if(!1!==n.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:f.copy(b),b.copy(C(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;E=Math.sqrt(t*t+o*o);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;O.copy(L(a,i))}}function F(e){if(!1!==n.enabled){switch(e.touches.length){case 0:p=o;break;case 1:p=s,b.copy(C(e.touches[0].pageX,e.touches[0].pageY)),f.copy(b)}n.dispatchEvent(D)}}function T(e){!1!==n.enabled&&e.preventDefault()}this.rotateCamera=function(){var e,t=new d.wb,o=new d.eb,a=new d.wb,i=new d.wb,c=new d.wb,s=new d.wb;return function(){s.set(b.x-f.x,b.y-f.y,0),(e=s.length())?(v.copy(n.object.position).sub(n.target),a.copy(v).normalize(),i.copy(n.object.up).normalize(),c.crossVectors(i,a).normalize(),i.setLength(b.y-f.y),c.setLength(b.x-f.x),s.copy(i.add(c)),t.crossVectors(s,v).normalize(),e*=n.rotateSpeed,o.setFromAxisAngle(t,e),v.applyQuaternion(o),n.object.up.applyQuaternion(o),w.copy(t),g=e):!n.staticMoving&&g&&(g*=Math.sqrt(1-n.dynamicDampingFactor),v.copy(n.object.position).sub(n.target),o.setFromAxisAngle(w,g),v.applyQuaternion(o),n.object.up.applyQuaternion(o)),f.copy(b)}}(),this.zoomCamera=function(){var e;p===r?(e=x/E,x=E,n.object.isPerspectiveCamera?v.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom*=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(j.y-y.y)*n.zoomSpeed)&&e>0&&(n.object.isPerspectiveCamera?v.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?y.copy(j):y.y+=(j.y-y.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new d.vb,t=new d.wb,o=new d.wb;return function(){if(e.copy(O).sub(k),e.lengthSq()){if(n.object.isOrthographicCamera){var a=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,i=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;e.x*=a,e.y*=i}e.multiplyScalar(v.length()*n.panSpeed),o.copy(v).cross(n.object.up).setLength(e.x),o.add(t.copy(n.object.up).setLength(e.y)),n.object.position.add(o),n.target.add(o),n.staticMoving?k.copy(O):k.add(e.subVectors(O,k).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(v.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,v.setLength(n.maxDistance)),y.copy(j)),v.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,v.setLength(n.minDistance)),y.copy(j)))},this.update=function(){v.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,v),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),u.distanceToSquared(n.object.position)>l&&(n.dispatchEvent(P),u.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(u.distanceToSquared(n.object.position)>l||h!==n.object.zoom)&&(n.dispatchEvent(P),u.copy(n.object.position),h=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){p=o,m=o,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),v.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(P),u.copy(n.object.position),h=n.object.zoom},this.dispose=function(){this.domElement.removeEventListener("contextmenu",T,!1),this.domElement.removeEventListener("mousedown",S,!1),this.domElement.removeEventListener("wheel",R,!1),this.domElement.removeEventListener("touchstart",M,!1),this.domElement.removeEventListener("touchend",F,!1),this.domElement.removeEventListener("touchmove",X,!1),document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",A,!1)},this.attachCallback=function(){this.domElement.addEventListener("contextmenu",T,!1),this.domElement.addEventListener("mousedown",S,!1),this.domElement.addEventListener("wheel",R,!1),this.domElement.addEventListener("touchstart",M,!1),this.domElement.addEventListener("touchend",F,!1),this.domElement.addEventListener("touchmove",X,!1)},this.attachCallback(),this.handleResize(),this.update()};(m.prototype=Object.create(d.q.prototype)).constructor=m;var v=n(49),f=function(e){var t=Object(a.useState)(),n=Object(r.a)(t,2),o=n[0],i=n[1];return Object(a.useEffect)((function(){i(function(){var e=function(){u()},t=document.getElementById("canvas-frame");if(null===t)return;var n=new d.jb,o=new d.yb({antialias:!0,powerPreference:"high-performance"}),a=new p(t,o.domElement,o,e),i=new d.Z(75,a.Aspect(),.1,1e3),c=new d.jb,s=new d.Z(75,a.Aspect(),.1,1e3),r=.1;o.setSize(a.w,a.h),o.setClearColor(4473924,1),i.position.z=5,s.position.z=5;var u=function(){console.log(a.w,a.h)},h=new m(i,t);h.target.set(0,0,0),h.rotateSpeed=8,h.noPan=!1,h.maxDistance=60,h.keys=[],h.dispose();var f=new d.a(4210752);n.add(f);var b=new d.ab(16777215,1,100);b.position.set(10,10,10),n.add(b);var w=new d.ab(16777215,1,200);w.position.set(-40,20,20),n.add(w);var g=new d.ab(16777215,1,200);g.position.set(-40,-20,-20),n.add(g);var y=new d.ab(16777215,1,200);y.position.set(-20,10,-10),n.add(y);var j=new Array,x=null,E=new d.t,k=new Array,O=new d.wb(2,2,2);function P(e){requestAnimationFrame(P),o.autoClear=!0,o.render(n,i),o.autoClear=!1,o.render(c,s),h.update()}n.add(E),P(0);var z=new d.t;n.add(z);var D=function(e,t,n,o,a){var i=new d.t,c=new d.n(.015,.015,e||t||n,3),s=new d.O({color:o}),r=new d.N(c,s);r.position.set(e/2,t/2,n/2);var l=new d.l(.05,.1,6),u=new d.O({color:o});r.userData={name:a,color:o,axis:new d.wb(e,t,n)};var h=new d.N(l,u);h.position.set(e,t,n);var p=h.position.clone().normalize();return h.rotation.set(p.z*Math.PI/2,p.y*Math.PI/2,-p.x*Math.PI/2),h.userData={name:a,color:o,axis:new d.wb(e,t,n)},r.rotation.set(p.z*Math.PI/2,p.y*Math.PI/2,-p.x*Math.PI/2),i.userData={name:a,color:o,axis:new d.wb(e,t,n)},i.add(r,h),i},L=.6,C=D(L,0,0,16776960,"x");z.add(C);var S=D(0,L,0,16711935,"y");z.add(S);var Y=D(0,0,L,43775,"z");z.add(Y);var A=new d.t;c.add(A);var R=D(1,0,0,16776960);A.add(R);var M=D(0,1,0,16711935);A.add(M);var X=D(0,0,.5,43775);A.add(X),A.position.set(-6*a.Aspect(),-6,-4.6);var F=new d.hb,T=null;F.params.Line={threshold:5};var N=!1,I={x:0,y:0,update:function(e){var t=new d.wb(e.x-I.x,e.y-I.y);return I.x=e.x,I.y=e.y,t},clone:function(){return{x:I.x,y:I.y}}},q=function(e){T&&(T.children[0].material.color.set(e),T.children[1].material.color.set(e))},Z=function(e){console.log("On mouse down"),N=!0,a.setPickPosition(e),I.update(a.pickPosition),F.setFromCamera(a.pickPosition,i);var t=F.intersectObjects(z.children,!0);null!==T&&(q(T.userData.color),T=null),t.length&&(h.enabled=!1,T=t[0].object.parent,q(16777215))};t.onmousedown=Z;var B=new Set,H=function(){B.forEach((function(e){var t=e.material;t.color=new d.k(10066329),t.reflectivity=1})),B.clear()};t.onclick=function(e){a.setPickPosition(e),F.setFromCamera(a.pickPosition,i);var t=F.intersectObjects(E.children);if(t.length){e.ctrlKey||H(),B.add(t[0].object);var n=t[0].object.material;n.color=new d.k(12272895),n.reflectivity=1.4;var o=t[0].object.position;z.position.set(o.x,o.y,o.z)}};var V=new d.hb;function W(e,t,n){for(var o=t.max.clone().sub(t.min),a=new Array,i=0;i<e.x+1;++i){a[i]=new Array;for(var c=0;c<e.y+1;++c){a[i][c]=new Array;for(var s=0;s<e.z+1;++s)a[i][c][s]=new d.wb(o.x/e.x*i,o.y/e.y*c,o.z/e.z*s),a[i][c][s].add(t.min),n(a[i][c][s],[i,c,s])}}return a}function G(e){if(null!==x){for(O=e;E.children.length;)E.remove(E.children[0]);var t=(new d.d).setFromObject(x);console.log(t);var n=function(e,t){return 0===e||e===t};j=W(e,t,(function(t,o){if(n(o[0],e.x)||n(o[1],e.y)||n(o[2],e.z)){var a=new d.ob(.042,16,16),i=new d.P({color:11184810}),c=new d.N(a,i);c.position.set(t.x,t.y,t.z),c.userData={xyz:o},E.add(c)}}))}}function J(e,t){for(var n=e,o=e;o++<t;)n*=o;return n}function Q(e,t){return e===(t=t<e-t?e-t:t)?1:J(t+1,e)/J(1,e-t)}function U(e,t,n,o,a,i,c){for(var s=Math.pow,l=new d.wb(0,0,0),u=0;u<=e;++u)for(var h=0;h<=t;++h)for(var p=0;p<=n;++p){var m=Q(e,u)*s(1-o,e-u)*s(o,u)*Q(t,h)*s(1-a,t-h)*s(a,h)*Q(n,p)*s(1-i,n-p)*s(i,p);l.add(c[u][h][p].clone().multiplyScalar(m))}return l.multiplyScalar(1/r),l}function $(){var e,t=Object(l.a)(k);try{for(t.s();!(e=t.n()).done;){for(var n=e.value,o=n.stu,a=new Float32Array(o.length),i=n.object.geometry.attributes.position,c=0;c<o.length;c+=3){var s=U(O.x,O.y,O.z,o[c],o[c+1],o[c+2],j);a[c]=s.x,a[c+1]=s.y,a[c+2]=s.z}i.set(a),i.needsUpdate=!0}}catch(r){t.e(r)}finally{t.f()}}t.onmousemove=function(e){if(null!==T&&N&&B.size){a.setPickPosition(e);var t=I.update(a.pickPosition);if(0!==t.length()){var n=T.userData.axis,o=n.clone().project(i);o.z=0,V.setFromCamera(a.pickPosition,i);var c=o.dot(t)/o.length()*(L/o.length())*.76,s=n.clone().multiplyScalar(c);z.position.add(s),B.forEach((function(e){e.position.add(s);var t=e.position,n=e.userData.xyz;j[n[0]][n[1]][n[2]].set(t.x,t.y,t.z)})),$()}}},t.onmouseup=function(e){N=!1,h.enabled=!0,null!==T&&(q(T.userData.color),T=null)};var K=new d.d;function _(e,t){for(var n=new Float32Array(e.length),o=t.max.clone().sub(t.min),a=0;a<e.length;++a)n[a]=(e[a]-t.min.x)/o.x,n[++a]=(e[a]-t.min.y)/o.y,n[++a]=(e[a]-t.min.z)/o.z;return n}function ee(e){k.push({object:e,stu:_(e.geometry.attributes.position.array,K)})}var te=new v.a,ne=null,oe=function(e,t){te.load(e,(function(e){x&&n.remove(x),r=t,K.setFromObject(e.scene),e.scene.scale.set(t,t,t),n.add(e.scene),x=e.scene,k=[],e.scene.traverse((function(e){e instanceof d.N&&e.geometry instanceof d.h&&ee(e)})),ne&&n.remove(ne);var o=new d.f(e.scene,new d.k(11154248));o.update(),n.add(o),ne=o,G(O)}))},ae=function(e){if("book"===e)oe("./book/scene.gltf",.1);else if("car"===e)oe("./car/scene.gltf",.003);else{ne&&n.remove(ne),x&&n.remove(x);var t=new d.Q({color:2200782,metalness:.5,roughness:.6}),o=null;if("sphere"===e)o=new d.nb(.5,64,64);else if("cube"===e)o=new d.e(1,1,1,8,8,8);else if("cylinder"===e)o=new d.m(.5,.5,1,32);else{if("donut"!==e)return;o=new d.sb(.5,.25,16,100)}var a=new d.N(o,t);K.setFromObject(a),x=a,G(O),k=[],ee(a),r=1,n.add(a)}};return ae("book"),h.attachCallback(),{updateCtrlDims:function(e,t,n){return G(new d.wb(e,t,n))},updateScene:function(e){return ae(e)},reset:function(){G(O),$()}}}())}),[]),Object(a.useEffect)((function(){if(o){var t=e.ctrlPointsDims;o.updateCtrlDims.apply(o,Object(s.a)(t))}}),[e.ctrlPointsDims]),Object(a.useEffect)((function(){o&&o.updateScene(e.scene)}),[e.scene]),null};var b=n(115),w=n(7),g=n(108),y=Object(w.a)({root:{color:"#52af77",height:8},thumb:{height:24,width:24,backgroundColor:"#fff",border:"2px solid currentColor",marginTop:-8,marginLeft:-12,"&:focus,&:hover,&$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{height:8,borderRadius:4},rail:{height:8,borderRadius:4}})(b.a),j=Object(g.a)((function(e){return{root:{flexGrow:1},Right:{maxHeight:"100vh",overflowY:"scroll",paddingLeft:20,paddingTop:e.spacing(2)},slider:{display:"inline"},sliderGroup:{marginTop:e.spacing(3)}}})),x=function(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null);return Object(a.useEffect)((function(){t.current&&n.current&&(t.current.style.width=n.current.style.width)}),[]),Object(o.jsxs)("div",{ref:n,className:"canvas-frame-wrapper",children:[Object(o.jsx)("div",{ref:t,id:"canvas-frame",className:"canvas-frame"}),e.children]})},E=n(109),k=n(111),O=n(114),P=n(113),z=n(110),D=n(112),L=(n(66),function(){return Object(o.jsx)("a",{href:"https://linwe2012.github.io/personal-page",children:Object(o.jsxs)("div",{className:"personal-page-wrap-white",children:[Object(o.jsx)("img",{className:"personal-page-avatar-white",src:"https://linwe2012.github.io/personal-page/static/img/me-removebg-preview-sqr.svg",alt:""}),Object(o.jsx)("div",{className:"personal-page-text-white",children:"Lin's Personal Page"})]})})}),C=["Lattice X","Lattice Y","Lattice Z"],S=["book","car","sphere","cube","donut"],Y=function(){var e=j(),t=Object(a.useState)([2,2,2]),n=Object(r.a)(t,2),i=n[0],c=n[1],l=Object(a.useState)(0),u=Object(r.a)(l,2),h=u[0],p=u[1];return Object(o.jsx)("div",{className:"App",children:Object(o.jsxs)(E.a,{container:!0,className:e.root,children:[Object(o.jsx)(E.a,{item:!0,xs:9,children:Object(o.jsx)(x,{children:Object(o.jsx)(f,{ctrlPointsDims:i,scene:S[h]})})}),Object(o.jsxs)(E.a,{item:!0,xs:3,className:e.Right,children:[Object(o.jsxs)(z.a,{variant:"filled",fullWidth:!0,children:[Object(o.jsx)(O.a,{htmlFor:"filled-scene",children:"Scene"}),Object(o.jsx)(D.a,{value:h,onChange:function(e){return p(e.target.value)},inputProps:{name:"scene",id:"filled-scene"},children:S.map((function(e,t){return Object(o.jsx)(P.a,{value:t,children:e},t)}))})]}),Object(o.jsx)("div",{className:e.sliderGroup,children:i.map((function(e,t){return Object(o.jsxs)("div",{style:{textAlign:"left"},children:[Object(o.jsx)(k.a,{display:"inline",children:C[t]}),Object(o.jsx)(y,{valueLabelDisplay:"auto",onChangeCommitted:function(e,n){var o=Object(s.a)(i);o[t]=Number(n),c(o)},defaultValue:2,min:1,max:10})]},t)}))}),Object(o.jsx)(L,{})]})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(o.jsx)(Y,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[68,1,2]]]);
//# sourceMappingURL=main.14464266.chunk.js.map